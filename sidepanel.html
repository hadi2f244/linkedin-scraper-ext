<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>LinkedIn Job Details</title>
    <link rel="stylesheet" href="sidepanel.css" />
</head>
<body>
<div id="root">
    <div class="header">
        <div id="status">Waiting for job data...</div>
    </div>

    <!-- Tab Navigation -->
    <div class="tab-navigation">
        <button class="tab-btn active" data-tab="job-details">ğŸ“‹ Job Details</button>
        <button class="tab-btn" data-tab="cover-letter">ğŸ“„ Cover Letter</button>
        <button class="tab-btn" data-tab="qa">â“ Q&A</button>
        <button class="tab-btn" data-tab="company-research">ğŸ¢ Company Research</button>
    </div>

    <!-- Tab: Job Details -->
    <div class="tab-content active" id="tab-job-details">
        <div id="content"></div>

        <div id="raw-text-container" class="raw-text-container collapsed">
            <div id="raw-text-preview" class="raw-text-preview"></div>
            <button id="read-more-btn" class="read-more-btn">Read more</button>
            <div id="raw-text-full" class="raw-text-full"></div>
        </div>

        <div class="button-group">
            <button id="send" disabled>Send to ChatGPT</button>
            <button id="refresh">Refresh Job Data</button>
        </div>

        <hr/>
        <div id="ai-status" class="muted" style="margin-top:6px"></div>
        <div id="ai-output" style="margin-top:6px; font-size:13px; line-height:1.35;"></div>
    </div>

    <!-- Tab: Cover Letter -->
    <div class="tab-content" id="tab-cover-letter">
        <div class="button-group">
            <button id="generate-cover-letter" disabled>Generate Cover Letter</button>
        </div>

        <div id="cover-letter-container" class="cover-letter-container" style="display: none;">
            <div id="cover-letter-status" class="muted" style="margin-bottom: 8px;">
                <span id="cover-letter-status-text"></span>
                <span id="editable-indicator" class="editable-indicator" style="display: none;">âœï¸ Editable</span>
            </div>
            <div id="cover-letter-text" class="cover-letter-text"></div>
            <div style="display: flex; gap: 8px; margin-top: 8px;">
                <button id="copy-cover-letter" class="copy-btn" style="display: none;">ğŸ“‹ Copy to Clipboard</button>
                <button id="save-pdf-cover-letter" class="copy-btn" style="display: none;">ğŸ’¾ Save as PDF</button>
            </div>
        </div>
    </div>

    <!-- Tab: Q&A -->
    <div class="tab-content" id="tab-qa">
        <div style="margin-bottom: 16px;">
            <label for="question-select" style="display: block; margin-bottom: 8px; font-weight: 600;">Select a Question:</label>
            <select id="question-select" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 13px;">
                <option value="">-- Select a question --</option>
            </select>
        </div>

        <div id="qa-status" class="muted" style="margin-bottom: 8px;">
            <span id="qa-status-text"></span>
        </div>
        <div id="qa-answer" class="qa-answer"></div>

        <div class="custom-question-section" style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #e0e0e0;">
            <label for="custom-question" style="display: block; margin-bottom: 8px; font-weight: 600;">Ask a Custom Question:</label>
            <textarea id="custom-question" placeholder="e.g., What are the key skills required for this role?" style="width: 100%; min-height: 60px; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-family: inherit; font-size: 13px;"></textarea>
            <button id="ask-custom-question" class="copy-btn" style="margin-top: 8px;">ğŸ¤” Get Answer</button>
            <div id="custom-answer" class="custom-answer" style="margin-top: 12px; display: none;"></div>
        </div>
    </div>

    <!-- Tab: Company Research -->
    <div class="tab-content" id="tab-company-research">
        <div style="margin-bottom: 16px;">
            <p style="color: #666; font-size: 13px; line-height: 1.5; margin-bottom: 12px;">
                Automatically gather company information from LinkedIn company page, job description, and company website.
            </p>

            <!-- Custom URLs Section -->
            <div style="margin-bottom: 16px; padding: 12px; background: #f5f5f5; border-radius: 4px;">
                <label for="custom-urls-input" style="display: block; margin-bottom: 8px; font-weight: 600; font-size: 13px;">
                    Additional URLs (optional, one per line):
                </label>
                <textarea
                    id="custom-urls-input"
                    placeholder="https://company.com/about&#10;https://company.com/blog/our-mission&#10;https://company.com/team"
                    style="width: 100%; min-height: 80px; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-family: monospace; font-size: 12px; resize: vertical;"
                ></textarea>
                <div style="margin-top: 8px; display: flex; gap: 8px;">
                    <button id="clear-custom-urls-btn" class="copy-btn" style="font-size: 12px; padding: 6px 12px;">ğŸ—‘ï¸ Clear URLs</button>
                    <span style="font-size: 11px; color: #666; line-height: 32px;">Add blog posts, press releases, or other relevant pages</span>
                </div>
            </div>

            <!-- Manual Content Section (Fallback for blocked websites) -->
            <div style="margin-bottom: 16px; padding: 12px; background: #fff3cd; border: 1px solid #ffc107; border-radius: 4px;">
                <div style="display: flex; align-items: center; margin-bottom: 8px;">
                    <label for="manual-content-input" style="font-weight: 600; font-size: 13px; flex: 1;">
                        ğŸ’¡ Manual Content (if websites are blocked):
                    </label>
                    <button id="toggle-manual-content" class="copy-btn" style="font-size: 11px; padding: 4px 8px;">Show/Hide</button>
                </div>
                <div id="manual-content-section" style="display: none;">
                    <p style="font-size: 11px; color: #856404; margin-bottom: 8px; line-height: 1.4;">
                        If automated fetching fails (timeouts, anti-bot protection), manually copy company information from their website and paste it here:
                    </p>
                    <textarea
                        id="manual-content-input"
                        placeholder="Paste company description, about us, mission statement, etc. from the company's website..."
                        style="width: 100%; min-height: 120px; padding: 8px; border: 1px solid #ffc107; border-radius: 4px; font-family: inherit; font-size: 12px; resize: vertical;"
                    ></textarea>
                    <div style="margin-top: 8px; display: flex; gap: 8px;">
                        <button id="clear-manual-content-btn" class="copy-btn" style="font-size: 12px; padding: 6px 12px;">ğŸ—‘ï¸ Clear</button>
                        <span style="font-size: 11px; color: #856404; line-height: 32px;">This content will be included in the research results</span>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button id="research-company-btn" class="copy-btn" disabled>ğŸ” Research Company</button>
            </div>
        </div>

        <div id="company-research-status" class="muted" style="margin-bottom: 12px;">
            <span id="company-research-status-text"></span>
        </div>

        <div id="company-research-progress" style="display: none; margin-bottom: 12px; padding: 12px; background: #e3f2fd; border-radius: 4px; font-size: 12px;">
            <div id="progress-linkedin" style="margin-bottom: 4px;">â³ Fetching LinkedIn company page...</div>
            <div id="progress-website" style="margin-bottom: 4px;">â³ Fetching company website...</div>
            <div id="progress-custom" style="margin-bottom: 4px;">â³ Fetching custom URLs...</div>
        </div>

        <div id="company-research-result" style="display: none;">
            <div style="background: #f9f9f9; border: 1px solid #e0e0e0; border-radius: 4px; padding: 12px; margin-bottom: 12px;">
                <div style="font-weight: 600; color: #0073b1; margin-bottom: 8px;">
                    <span id="company-research-name"></span>
                </div>
                <div id="company-research-content" style="color: #333; line-height: 1.6; white-space: pre-wrap; font-size: 13px;"></div>
            </div>
            <div style="font-size: 11px; color: #999; margin-top: 8px;">
                <div id="company-research-sources" style="margin-bottom: 4px;"></div>
                <div id="company-research-timestamp"></div>
            </div>
        </div>

        <div id="company-research-error" style="display: none; color: #c62828; padding: 12px; background: #ffebee; border-radius: 4px; margin-top: 12px;"></div>
    </div>

    <p class="muted" style="margin-top:10px; font-size: 11px;">
        Configure in <a id="open-options" href="#">options</a>
    </p>
</div>
<script src="copilot-auth.js"></script>
<script src="sidepanel.js"></script>
</body>
</html>

